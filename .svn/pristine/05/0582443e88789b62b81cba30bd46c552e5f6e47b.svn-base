<template>
  <createView :loading="loading" :body-style="{ height: '100%',padding:0,overflow: 'auto'}">
    <div>
      <el-tabs v-model="activeNameEdit" @tab-click="handleClick">
        <el-tab-pane label="初始客户信息" name="csxx">
          <flexbox direction="column" align="stretch" class="create-container">
            <div class="create-flex">
              <sections title="基本信息">
                <div class="input-box">
                  <label class="input-label">客户名称:</label>
                  <div
                    style="float:left;overflow: hidden;white-space: nowrap"
                    :title="from.code"
                    class="el-span"
                    v-text="from.name"
                  ></div>
                </div>
                <div class="input-box">
                  <label class="input-label">销售负责人:</label>
                  <span class="el-span" v-text="ywyName"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">所属集团:</label>
                  <span class="el-span" v-text="from.ssjt"></span>
                </div>
                <div class="input-box"></div>
                <div class="input-box">
                  <label class="input-label">客户编码:</label>
                  <div style="float:left;overflow: hidden" :title="from.code" v-text="from.code"></div>
                </div>
                <div class="input-box">
                  <label class="input-label">规模:</label>
                  <span class="el-span" v-text="from.khgm"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">创建人:</label>
                  <div v-text="creatorName"></div>
                </div>
                <div class="input-box">
                  <label class="input-label">创建日期:</label>
                  <div v-text="from.createDate"></div>
                </div>
                <div class="input-box">
                  <label class="input-label">所在国家:</label>
                  <span class="el-span" v-text="from.khgj"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">手机号码:</label>
                  <span class="el-span" v-text="from.khsjhm"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">详细地址:</label>
                  <span class="el-span" v-text="from.address"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">QQ:</label>
                  <span class="el-span" v-text="from.khqq"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">所在省:</label>
                  <span class="el-span" v-text="from.khsf"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">电话:</label>
                  <span class="el-span" v-text="from.businessTel"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">邮编:</label>
                  <span class="el-span" v-text="from.postcode"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">skype:</label>
                  <span class="el-span" v-text="from.skype"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">所在市:</label>
                  <span class="el-span" v-text="from.khcs"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">传真:</label>
                  <span class="el-span" v-text="from.cz"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">网址:</label>
                  <span class="el-span" v-text="from.website"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">旺旺:</label>
                  <span class="el-span" v-text="from.khww"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">所在县:</label>
                  <span class="el-span" v-text="from.khqx"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">Email:</label>
                  <span class="el-span" v-text="from.email"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">共享人:</label>
                  <span class="el-span" v-text="gxrName"></span>
                </div>
              </sections>
            </div>
            <div class="create-flex">
              <sections title="地址信息和财务信息">
                <div class="input-box">
                  <label class="input-label">收货国家:</label>
                  <span class="el-span" v-text="from.shgj"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">收货城市:</label>
                  <span class="el-span" v-text="from.shcs"></span>
                </div>
                <div class="input-box"></div>
                <div class="input-box"></div>
                <div class="input-box">
                  <label class="input-label">收货地址1:</label>
                  <span class="el-span" v-text="from.shdz"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">收货地址2:</label>
                  <span class="el-span" v-text="from.shdzb"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">收货地址3:</label>
                  <span class="el-span" v-text="from.shdzc"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">收货地址4:</label>
                  <span class="el-span" v-text="from.shdzd"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">开户行:</label>
                  <span class="el-span" v-text="from.khyh"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">开户名:</label>
                  <span class="el-span" v-text="from.khm"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">银行账号:</label>
                  <span class="el-span" v-text="from.yhzh"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">信用额度:</label>
                  <span class="el-span" v-text="from.xyed"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">税号:</label>
                  <span class="el-span" v-text="from.khsh"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">开票地址:</label>
                  <span class="el-span" v-text="from.kpdz"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">交往频率超期预警:</label>
                  <span style="width: 50px;line-height: 25px;float: left;" v-text="from.jwpl"></span>
                  <span style="display: inline-block;line-height: 25px;">天</span>
                </div>
                <div class="input-box">
                  <label class="input-label">欠款额度:</label>
                  <span style="width: 50px;line-height: 25px;float: left;" v-text="from.qked"></span>
                  <span style="display: inline-block;line-height: 25px;">元</span>
                </div>
                <div style="width:100%;margin-bottom:5px;float:left">
                  <label
                    style="width: 120px;line-height: 25px;float: left;"
                    class="input-label"
                  >收款期限设置:</label>
                  <span style="width: 60px;line-height: 25px;float: left;" v-text="from.skqxszFlag"></span>
                  <span style="width: 50px;line-height: 25px;float: left;" v-text="from.skqxszDays"></span>
                  <span style="width: 120px;line-height: 25px;float: left;">天为收款期限</span>
                </div>
                <div class="input-box">
                  <label style="float:left" class="input-label">超期无购买提示:</label>
                  <span style="float: left;line-height: 25px;margin-right: 10px;">连续</span>
                  <span style="width: 50px;line-height: 25px;float: left;" v-text="from.cqwgmts"></span>
                  <span style="display: inline-block;line-height: 25px;margin-left: 10px;">天无购买提醒</span>
                </div>
              </sections>
            </div>
            <div class="create-flex">
              <sections title="地址信息和财务信息">
                <div class="input-box">
                  <label class="input-label">客户来源:</label>
                  <span class="el-span" v-text="from.customerFrom"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">客户类型:</label>
                  <span class="el-span" v-text="from.khlx"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">销售方式:</label>
                  <span class="el-span" v-text="from.xsfs"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">预设售价:</label>
                  <span class="el-span" v-text="from.yssj"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">行业属性:</label>
                  <span class="el-span" v-text="from.hysx"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">企业性质:</label>
                  <span class="el-span" v-text="from.qyxz"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">法定代表人:</label>
                  <span class="el-span" v-text="from.fddbr"></span>
                </div>
                <div class="input-box">
                  <label class="input-label">委托代理人:</label>
                  <span class="el-span" v-text="from.wtdlr"></span>
                </div>
                <div class="input-box" style="width:100%">
                  <label class="input-label">上传附件</label>
                  <ul class="uploadStyle">
                    <li v-for="(item,index) in fileList" :key="index">
                      <span>{{item.name}}</span>
                      <i @click="deleteUpload(index)" class="el-icon-close"></i>
                    </li>
                  </ul>
                </div>
                <div class="input-boxB" style="margin:8px 0">
                  <label class="input-label">所询产品信息:</label>
                  <span style="width: 90%;" class="el-span" v-text="from.sxcpxx"></span>
                </div>
                <div class="input-boxB" style="margin:8px 0">
                  <label class="input-label">企业描述:</label>
                  <span style="width: 90%;" class="el-span" v-text="from.description"></span>
                </div>
                <div class="input-boxB" style="margin:8px 0">
                  <label class="input-label">备注:</label>
                  <span style="width: 90%;" class="el-span" v-text="from.remark"></span>
                </div>
              </sections>
            </div>
            <div class="create-flex">
              <sections title="客户联系人">
                <el-table :data="tableData" style="width: 100%">
                  <el-table-column prop="contactName" label="姓名"></el-table-column>
                  <el-table-column prop="contactGender" label="性别"></el-table-column>
                  <el-table-column prop="zycd" label="重要程度"></el-table-column>
                  <el-table-column prop="zw" label="职位"></el-table-column>
                  <el-table-column prop="sj" label="手机"></el-table-column>
                  <el-table-column prop="contactPhone" label="工作电话"></el-table-column>
                  <el-table-column prop="contactEmail" label="E-mail"></el-table-column>
                  <el-table-column prop="contactQq" label="QQ"></el-table-column>
                  <el-table-column prop="cz" label="传真"></el-table-column>
                  <el-table-column prop="contactBirthday" label="生日"></el-table-column>
                  <el-table-column prop="remark" label="备注"></el-table-column>
                </el-table>
              </sections>
            </div>
            <div class="handle-bar">
              <el-button @click="hidenView" type="info">关闭</el-button>
            </div>
          </flexbox>
        </el-tab-pane>
        <el-tab-pane label="修改客户信息" name="editxx">
          <flexbox direction="column" align="stretch" class="create-container">
            <div class="create-flex">
              <sections title="基本信息">
                <div class="input-box">
                  <label class="input-label">客户名称:</label>
                  <span
                    style="float:left;overflow: hidden;white-space: nowrap"
                    :title="from.code"
                    v-if="auditType"
                    class="el-span"
                    v-text="from.name"
                  ></span>
                  <el-input
                    v-else
                    @input="getName"
                    @blur="nameBlur"
                    clearable
                    placeholder="请输入客户名称"
                    v-model="from.name"
                  ></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">销售负责人:</label>
                  <span v-if="auditType" class="el-span" v-text="ywyName"></span>
                  <el-input
                    v-else
                    :readonly="true"
                    clearable
                    placeholder="请选择销售负责人"
                    v-model="ywyName"
                  >
                    <el-button @click="ywyDialog" slot="append" icon="el-icon-plus"></el-button>
                  </el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">所属集团:</label>
                  <span v-if="auditType" class="el-span" v-text="from.ssjt"></span>
                  <el-input v-else clearable placeholder="请输入所属集团" v-model="from.ssjt">
                    <el-button @click="customerDialog" slot="append" icon="el-icon-plus"></el-button>
                  </el-input>
                </div>
                <div class="input-box"></div>
                <div class="input-box">
                  <label class="input-label">客户编码:</label>
                  <div style="float:left;overflow: hidden" :title="from.code" v-text="from.code"></div>
                </div>
                <div class="input-box">
                  <label class="input-label">规模:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khgm"></span>
                  <el-select v-else v-model="from.khgm" placeholder="请选择">
                    <el-option :key="''" :label="'请选择'" :value="''"></el-option>
                    <el-option
                      v-for="item in khgmList"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">创建人:</label>
                  <div v-text="creatorName"></div>
                </div>
                <div class="input-box">
                  <label class="input-label">创建日期:</label>
                  <div v-text="from.createDate"></div>
                </div>
                <div class="input-box">
                  <label class="input-label">所在国家:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khgj"></span>
                  <el-input v-else clearable placeholder="请输入所在国家" v-model="from.khgj"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">手机号码:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khsjhm"></span>
                  <el-input
                    v-else
                    clearable
                    placeholder="请输入手机号码"
                    maxlength="11"
                    v-model="from.khsjhm"
                  ></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">详细地址:</label>
                  <span v-if="auditType" class="el-span" v-text="from.address"></span>
                  <el-input v-else clearable placeholder="请输入详细地址" v-model="from.address"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">QQ:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khqq"></span>
                  <el-input v-else clearable placeholder="请输入QQ" v-model="from.khqq"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">所在省:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khsf"></span>
                  <el-select v-else v-model="from.khsf" placeholder="请选择" @change="provinceChanged">
                    <el-option :key="''" :label="'请选择'" :value="''"></el-option>
                    <el-option
                      v-for="item in provinces"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">电话:</label>
                  <span v-if="auditType" class="el-span" v-text="from.businessTel"></span>
                  <el-input v-else clearable placeholder="请输入电话" v-model="from.businessTel"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">邮编:</label>
                  <span v-if="auditType" class="el-span" v-text="from.postcode"></span>
                  <el-input v-else clearable placeholder="请输入邮编" v-model="from.postcode"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">skype:</label>
                  <span v-if="auditType" class="el-span" v-text="from.skype"></span>
                  <el-input v-else clearable placeholder="请输入skype" v-model="from.skype"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">所在市:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khcs"></span>
                  <el-select v-else v-model="from.khcs" :loading="loadingCity" placeholder="请选择">
                    <el-option :key="''" :label="'请选择'" :value="''"></el-option>
                    <el-option
                      v-for="item in cities"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">传真:</label>
                  <span v-if="auditType" class="el-span" v-text="from.cz"></span>
                  <el-input v-else clearable placeholder="请输入传真" v-model="from.cz"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">网址:</label>
                  <span v-if="auditType" class="el-span" v-text="from.website"></span>
                  <el-input v-else clearable placeholder="请输入网址" v-model="from.website"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">旺旺:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khww"></span>
                  <el-input v-else clearable placeholder="请输入旺旺" v-model="from.khww"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">所在县:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khqx"></span>
                  <el-input v-else clearable placeholder="请输入所在县" v-model="from.khqx"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">Email:</label>
                  <span v-if="auditType" class="el-span" v-text="from.email"></span>
                  <el-input v-else clearable placeholder="请输入Email" v-model="from.email"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">共享人:</label>
                  <span v-if="auditType" class="el-span" v-text="gxrName"></span>
                  <el-input
                    v-else
                    :readonly="true"
                    clearable
                    placeholder="请选择共享人"
                    v-model="gxrName"
                  >
                    <el-button @click="gxrDialog" slot="append" icon="el-icon-plus"></el-button>
                  </el-input>
                </div>
              </sections>
            </div>
            <div class="create-flex">
              <sections title="地址信息和财务信息">
                <div class="input-box">
                  <label class="input-label">收货国家:</label>
                  <span v-if="auditType" class="el-span" v-text="from.shgj"></span>
                  <el-input v-else clearable placeholder="请输入收货国家" v-model="from.shgj"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">收货城市:</label>
                  <span v-if="auditType" class="el-span" v-text="from.shcs"></span>
                  <el-input v-else clearable placeholder="请输入客户名称" v-model="from.shcs"></el-input>
                </div>
                <div class="input-box"></div>
                <div class="input-box"></div>
                <div class="input-box">
                  <label class="input-label">收货地址1:</label>
                  <span v-if="auditType" class="el-span" v-text="from.shdz"></span>
                  <el-input v-else clearable placeholder="请输入收货地址1" v-model="from.shdz"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">收货地址2:</label>
                  <span v-if="auditType" class="el-span" v-text="from.shdzb"></span>
                  <el-input v-else clearable placeholder="请输入收货地址2" v-model="from.shdzb"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">收货地址3:</label>
                  <span v-if="auditType" class="el-span" v-text="from.shdzc"></span>
                  <el-input v-else clearable placeholder="请输入收货地址3" v-model="from.shdzc"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">收货地址4:</label>
                  <span v-if="auditType" class="el-span" v-text="from.shdzd"></span>
                  <el-input v-else clearable placeholder="请输入收货地址4" v-model="from.shdzd"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">开户行:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khyh"></span>
                  <el-input v-else clearable placeholder="请输入开户行" v-model="from.khyh"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">开户名:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khm"></span>
                  <el-input v-else clearable placeholder="请输入开户名" v-model="from.khm"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">银行账号:</label>
                  <span v-if="auditType" class="el-span" v-text="from.yhzh"></span>
                  <el-input v-else clearable placeholder="请输入银行账号" v-model="from.yhzh"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">信用额度:</label>
                  <span v-if="auditType" class="el-span" v-text="from.xyed"></span>
                  <el-input v-else clearable placeholder="请输入详细地址" v-model="from.xyed"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">税号:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khsh"></span>
                  <el-input v-else clearable placeholder="请输入税号" v-model="from.khsh"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">开票地址:</label>
                  <span v-if="auditType" class="el-span" v-text="from.kpdz"></span>
                  <el-input v-else clearable placeholder="请输入开票地址" v-model="from.kpdz"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">交往频率超期预警:</label>
                  <span
                    style="width: 50px;line-height: 25px;float: left;"
                    v-if="auditType"
                    class="el-span"
                    v-text="from.jwpl"
                  ></span>
                  <el-input @keyup.native="from.jwpl = from.jwpl.replace(/[^\d]/g,'')" v-else clearable placeholder="请输入交往频率超期预警" v-model="from.jwpl"></el-input>
                  <span style="display: inline-block;line-height: 25px;">天</span>
                </div>
                <div class="input-box">
                  <label class="input-label">欠款额度:</label>
                  <span
                    style="width: 50px;line-height: 25px;float: left;"
                    v-if="auditType"
                    class="el-span"
                    v-text="from.qked"
                  ></span>
                  <el-input v-else clearable placeholder="请输入欠款额度" v-model="from.qked"></el-input>
                  <span style="display: inline-block;line-height: 25px;">元</span>
                </div>
                <div style="width:100%;margin-bottom:5px;float:left">
                  <label class="input-label">收款期限设置:</label>
                  <div
                    style="display: inline-block;width:60px"
                    v-if="auditType"
                    v-text="from.skqxszFlag"
                  ></div>
                  <div
                    style="display: inline-block;width:20px"
                    v-if="auditType"
                    v-text="from.skqxszDays"
                  ></div>
                  <el-radio
                    v-if="!auditType"
                    style="margin-left: 30px;"
                    @change="fhhChange"
                    v-model="from.skqxszFlag"
                    label="发货后"
                  >发货后</el-radio>
                  <el-input
                    v-if="!auditType"
                    @keyup.native="fhhData = fhhData.replace(/[^\d]/g,'')"
                    :readonly="from.skqxszFlag != '发货后'"
                    style="width:100px"
                    clearable
                    v-model="fhhData"
                  ></el-input>
                  <span>天为收款期限</span>
                  <el-radio
                    v-if="!auditType"
                    style="margin:0 55px  0 54px;"
                    @change="kphChange"
                    v-model="from.skqxszFlag"
                    label="开票后"
                  >开票后</el-radio>
                  <el-input
                    v-if="!auditType"
                    :readonly="from.skqxszFlag != '开票后'"
                    @keyup.native="kphData = kphData.replace(/[^\d]/g,'')"
                    style="width:100px"
                    clearable
                    v-model="kphData"
                  ></el-input>
                  <span v-if="!auditType">天为收款期限</span>
                </div>
                <div class="input-box">
                  <label class="input-label">超期无购买提示:</label>
                  <span style="float: left;line-height: 25px;margin-right: 10px;">连续</span>
                  <span v-if="auditType" class="el-span" v-text="from.cqwgmts"></span>
                  <el-input @keyup.native="from.cqwgmts = from.cqwgmts.replace(/[^\d]/g,'')" v-else style="width:100px" clearable v-model="from.cqwgmts"></el-input>
                  <span style="display: inline-block;line-height: 25px;margin-left: 10px;">天无购买提醒</span>
                </div>
              </sections>
            </div>
            <div class="create-flex">
              <sections title="地址信息和财务信息">
                <div class="input-box">
                  <label class="input-label">客户来源:</label>
                  <span v-if="auditType" class="el-span" v-text="from.customerFrom"></span>
                  <el-select v-else v-model="from.customerFrom" placeholder="请选择">
                    <el-option
                      v-for="item in customerFromList"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">客户类型:</label>
                  <span v-if="auditType" class="el-span" v-text="from.khlx"></span>
                  <el-select v-else v-model="from.khlx" placeholder="请选择">
                    <el-option
                      v-for="item in khlxList"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">销售方式:</label>
                  <span v-if="auditType" class="el-span" v-text="from.xsfs"></span>
                  <el-select v-else v-model="from.xsfs" placeholder="请选择">
                    <el-option
                      v-for="item in xsfsList"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">预设售价:</label>
                  <span v-if="auditType" class="el-span" v-text="from.yssj"></span>
                  <el-select v-else v-model="from.yssj" placeholder="请选择">
                    <el-option
                      v-for="item in yssjList"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">行业属性:</label>
                  <span v-if="auditType" class="el-span" v-text="from.hysx"></span>
                  <el-select v-else v-model="from.hysx" placeholder="请选择">
                    <el-option
                      v-for="item in hysxList"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">企业性质:</label>
                  <span v-if="auditType" class="el-span" v-text="from.qyxz"></span>
                  <el-select v-else v-model="from.qyxz" placeholder="请选择">
                    <el-option
                      v-for="item in qyxzList"
                      :key="item.name"
                      :label="item.name"
                      :value="item.name"
                    ></el-option>
                  </el-select>
                </div>
                <div class="input-box">
                  <label class="input-label">法定代表人:</label>
                  <span v-if="auditType" class="el-span" v-text="from.fddbr"></span>
                  <el-input v-else clearable placeholder="请输入法定代表人" v-model="from.fddbr"></el-input>
                </div>
                <div class="input-box">
                  <label class="input-label">委托代理人:</label>
                  <span v-if="auditType" class="el-span" v-text="from.wtdlr"></span>
                  <el-input v-else clearable placeholder="请输入委托代理人" v-model="from.wtdlr"></el-input>
                </div>
                <div class="input-box" style="width:100%">
                  <label class="input-label">上传附件</label>
                  <a v-if="!auditType" href="javascript:;" class="a-upload">
                    <input multiple="multiple" @change="xhUploadFile" type="file" name id />点击这里上传文件(上限5个)
                  </a>
                  <ul class="uploadStyle">
                    <li v-for="(item,index) in fileList" :key="index">
                      <span>{{item.name}}</span>
                      <i @click="deleteUpload(index)" class="el-icon-close"></i>
                    </li>
                  </ul>
                </div>
                <div class="input-boxB" style="margin:8px 0">
                  <label class="input-label">所询产品信息:</label>
                  <span style="width: 90%;" v-if="auditType" class="el-span" v-text="from.sxcpxx"></span>
                  <el-input
                    v-else
                    resize="none"
                    type="textarea"
                    :rows="2"
                    maxlength="200"
                    show-word-limit
                    placeholder="请输入内容"
                    v-model="from.sxcpxx"
                  ></el-input>
                </div>
                <div class="input-boxB" style="margin:8px 0">
                  <label class="input-label">企业描述:</label>
                  <span
                    style="width: 90%;"
                    v-if="auditType"
                    class="el-span"
                    v-text="from.description"
                  ></span>
                  <el-input
                    v-else
                    resize="none"
                    type="textarea"
                    :rows="2"
                    maxlength="200"
                    show-word-limit
                    placeholder="请输入企业描述"
                    v-model="from.description"
                  ></el-input>
                </div>
                <div class="input-boxB" style="margin:8px 0">
                  <label class="input-label">备注:</label>
                  <span style="width: 90%;" v-if="auditType" class="el-span" v-text="from.remark"></span>
                  <el-input
                    v-else
                    resize="none"
                    type="textarea"
                    maxlength="200"
                    show-word-limit
                    :rows="1"
                    placeholder="请输入备注"
                    v-model="from.remark"
                  ></el-input>
                </div>
              </sections>
            </div>
            <div class="create-flex">
              <sections title="客户联系人">
                <el-table :data="tableData" style="width: 100%">
                  <el-table-column label="姓名">
                    <template slot="header" slot-scope="scope">
                      <span>姓名</span>
                      <span style="color:red">*</span>
                    </template>
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.contactName"></span>
                      <el-input v-else clearable v-model="scope.row.contactName"></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="性别">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.contactGender"></span>
                      <el-select v-else v-model="scope.row.contactGender" placeholder="请选择">
                        <el-option
                          v-for="item in contactGenderList"
                          :key="item.name"
                          :label="item.name"
                          :value="item.name"
                        ></el-option>
                      </el-select>
                    </template>
                  </el-table-column>
                  <el-table-column label="重要程度">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.zycd"></span>
                      <el-select v-else v-model="scope.row.zycd" placeholder="请选择">
                        <el-option
                          v-for="item in zycdList"
                          :key="item.name"
                          :label="item.name"
                          :value="item.name"
                        ></el-option>
                      </el-select>
                    </template>
                  </el-table-column>
                  <el-table-column label="职位">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.zw"></span>
                      <el-input v-else clearable v-model="scope.row.zw"></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="手机">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.sj"></span>
                      <el-input
                        maxlength="11"
                        @keyup.native="scope.row.sj = scope.row.sj.replace(/[^\d]/g,'')"
                        v-else
                        clearable
                        v-model="scope.row.sj"
                      ></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="工作电话">
                    <template slot="header" slot-scope="scope">
                      <span>工作电话</span>
                      <span style="color:red">*</span>
                    </template>
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.contactPhone"></span>
                      <el-input
                        @keyup.native="scope.row.contactPhone = scope.row.contactPhone.replace(/[^\d]/g,'')"
                        v-else
                        clearable
                        v-model="scope.row.contactPhone"
                      ></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="E-mail">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.contactEmail"></span>
                      <el-input
                        @blur="contactEmailInput(scope.row)"
                        v-else
                        clearable
                        v-model="scope.row.contactEmail"
                      ></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="QQ">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.contactQq"></span>
                      <el-input v-else clearable v-model="scope.row.contactQq"></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="传真">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.cz"></span>
                      <el-input v-else clearable v-model="scope.row.cz"></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="生日">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.contactBirthday"></span>
                      <el-date-picker
                        v-else
                        value-format="yyyy-MM-dd"
                        v-model="scope.row.contactBirthday"
                        type="date"
                        placeholder="选择日期"
                      ></el-date-picker>
                    </template>
                  </el-table-column>
                  <el-table-column label="备注">
                    <template slot-scope="scope">
                      <span v-if="auditType" class="el-span" v-text="scope.row.remark"></span>
                      <el-input v-else clearable v-model="scope.row.remark"></el-input>
                    </template>
                  </el-table-column>
                  <el-table-column label="操作">
                    <template slot-scope="scope">
                      <el-button
                        v-if="scope.$index != 0"
                        style="color:red"
                        @click="deleteTable(scope)"
                        type="text"
                      >删除</el-button>
                    </template>
                  </el-table-column>
                </el-table>
              </sections>
            </div>
            <div class="handle-bar">
              <el-button v-if="!auditType" icon="el-icon-plus" @click="appendClick" type="text">添加一行</el-button>
              <el-button v-if="!auditType" type="success" @click="successClick">保存</el-button>
              <el-button v-if="auditType" type="success" @click="auditClick(1)">审核通过</el-button>
              <el-button v-if="auditType" type="info" @click="auditClick(2)">审核不通过</el-button>

              <el-button @click="hidenView" type="info">关闭</el-button>
            </div>
          </flexbox>
        </el-tab-pane>
      </el-tabs>
    </div>

    <!-- 所属集团 -->
    <el-dialog
      title="客户列表"
      :visible.sync="dialogVisible"
      width="60%"
      style="margin-top:-5vh"
      :before-close="handleClose"
      :modal-append-to-body="false"
    >
      <div class="dialog-box">
        <label class="input-label">客户名称</label>
        <el-input placeholder="请输入客户名称" clearable v-model="dialogFrom.name"></el-input>
      </div>
      <div class="dialog-box">
        <label class="input-label">客户编码</label>
        <el-input placeholder="请输入客户编码" clearable v-model="dialogFrom.code"></el-input>
      </div>
      <div class="dialog-box">
        <el-button type="primary" @click="search">查询</el-button>
        <el-button @click="reset">重置</el-button>
      </div>
      <div class="table-box">
        <el-table :data="userTableData" style="width: 100%" height="500">
          <el-table-column label="客户名称">
            <template slot-scope="scope">
              <span
                @click="queryName(scope.row)"
                style="color: #3E84E9;cursor: pointer"
                v-text="scope.row.name"
              ></span>
            </template>
          </el-table-column>
          <el-table-column prop="code" label="客户编码"></el-table-column>
        </el-table>
      </div>
      <el-pagination
        @size-change="handleSizeChange"
        @current-change="handleCurrentChange"
        :current-page.sync="dialogFrom.page"
        :page-size="dialogFrom.limit"
        layout="prev, pager, next, jumper"
        :total="total"
      ></el-pagination>
      <span slot="footer" class="dialog-footer">
        <el-button @click="dialogVisible = false">取 消</el-button>
      </span>
    </el-dialog>
    <!-- 销售负责人 -->

    <!-- 共享人 -->
    <gxrDialog
      @gxrDialogTreeData="gxrDialogTreeData"
      @close="gxrDialogStatus = false"
      :gxrDialogStatus="gxrDialogStatus"
    ></gxrDialog>

    <el-dialog
      :modal-append-to-body="false"
      title="审核不通过原因"
      :visible.sync="auditDialog"
      width="30%"
      :before-close="handleCloseSh"
    >
      <span>
        <el-input v-model="message" placeholder="请输入内容"></el-input>
      </span>
      <span slot="footer" class="dialog-footer">
        <el-button @click="auditDialog = false">取 消</el-button>
        <el-button type="primary" @click="auditDialogSubmit">确 定</el-button>
      </span>
    </el-dialog>
  </createView>
</template>

<script>
import createView from "../../components/createView";
import sections from "../../components/sections";
import Lockr from "lockr";
import dataList from "../../components/Json";
import { xbjQueryCustomer } from "@/api/crm/xbjTable";
import {
  deptQueryDeptTreeAndUser,
  roleQueryRoleAndUser,
  crmCustomeraddOrUpdate,
  crmCustomerQueryById,
} from "@/api/crm/ggkhc";
import { crmCustomerFileUpload, usersList } from "@/api/common";
import {
  crmCustomerQueryEditById,
  crmCustomerCheckStatus,
  crmCustomerAddOrUpdate,
  crmCustomerValidataName
} from "@/api/crm/khxxgl";
import { EventBus } from "../../../utils/eventBus";
import gxrDialog from "../../components/gxrDialog";
export default {
  name: "",
  components: {
    createView,
    sections,
    gxrDialog,
  },
  props: {},
  watch: {},
  data() {
    return {
      auditType: true,
      widowData: {},
      toViewType: true,
      reviewType: true,
      activeNameEdit: "editxx",
      dialogGxr: false,
      gxrName: "",
      xsfzrRoleId: "",
      realRadio: "",
      realname: "",
      realStatus: "1",
      realtableData: [],
      realStatusList: [
        { name: "在职", id: "1" },
        { name: "离职", id: "0" },
      ],
      ywyName: "",
      editData: {},
      defaultProps: {
        label: "name",
        children: "children",
      },
      defaultPropsR: {
        label: "roleName",
        children: "user",
      },
      treeData: [],
      treeDataR: [],
      activeName: "department",
      dialogYwy: false,
      fhhData: "",
      kphData: "",
      dialogFrom: {
        name: "",
        code: "",
        page: 1,
        limit: 15,
      },
      total: 0,
      dialogVisible: false,
      loading: false,
      khxxglDetailTitle: "",
      fileList: [],
      creatorName: "",
      from: {
        customerId: "",
        name: "",
        ywy: "",
        code: "",
        ssjt: "",
        khgm: "",
        createDate: "",
        khgj: "",
        khsjhm: "",
        address: "",
        khqq: "",
        khsf: "",
        businessTel: "",
        postcode: "",
        skype: "",
        khcs: "",
        cz: "",
        website: "",
        khww: "",
        khqx: "",
        email: "",
        gxr: "",
        shgj: "",
        shcs: "",
        shdz: "",
        shdzb: "",
        shdzc: "",
        shdzd: "",
        khyh: "",
        khm: "",
        yhzh: "",
        xyed: "",
        kpdz: "",
        khsh: "",
        jwpl: "",
        qked: "",
        skqxszFlag: "",
        skqxszDays: "",
        cqwgmts: "",
        customerFrom: "",
        khlx: "",
        xsfs: "",
        yssj: "",
        hysx: "",
        qyxz: "",
        fddbr: "",
        wtdlr: "",
        sxcpxx: "",
        description: "",
        remark: "",
        creator: "",
      },
      khgmList: [
        { name: "微型(10人以下)" },
        { name: "小型(10-100人)" },
        { name: "中小型(100-500人)" },
        { name: "中型(500-1000人)" },
        { name: "大型(1000人以上)" },
      ],
      customerFromList: [
        { name: "网络搜索" },
        { name: "官网数据接入" },
        { name: "客户介绍" },
        { name: "广告" },
        { name: "报纸杂志" },
        { name: "户外媒体" },
        { name: "朋友推荐" },
        { name: "其他" },
      ],
      khlxList: [
        { name: "一般客户" },
        { name: "VIP客户" },
        { name: "潜在客户" },
        { name: "长期跟踪客户" },
        { name: "重要客户" },
        { name: "一般合作客户" },
        { name: "已流失客户" },
      ],
      xsfsList: [
        { name: "直接销售" },
        { name: "OEM" },
        { name: "一级经销商" },
        { name: "代理" },
        { name: "二级经销商" },
      ],
      yssjList: [
        { name: "参考出售价" },
        { name: "一级批发价" },
        { name: "二级批发价" },
        { name: "三级批发价" },
        { name: "四级批发价" },
        { name: "五级批发价" },
      ],
      hysxList: [
        { name: "机电" },
        { name: "食品" },
        { name: "生物化工" },
        { name: "IT" },
        { name: "磨具" },
        { name: "机械重工" },
      ],
      qyxzList: [
        { name: "私营企业" },
        { name: "合资企业" },
        { name: "外资企业" },
        { name: "独资企业" },
        { name: "国家事业" },
      ],
      zycdList: [
        { name: "关键联系人" },
        { name: "重要联系人" },
        { name: "普通联系人" },
        { name: "一般联系人" },
        { name: "特别联系人" },
        { name: "主管" },
      ],
      contactGenderList: [{ name: "男" }, { name: "女" }],
      userTableData: [],
      tableData: [
        {
          contactName: "",
          contactGender: "",
          zw: "",
          sj: "",
          contactPhone: "",
          contactEmail: "",
          contactQq: "",
          cz: "",
          contactBirthday: "",
          remark: "",
          zycd: "",
        },
      ],
      provinces: [],
      cities: [],
      loadingCity: false,
      message: "",
      auditDialog: false,
      gxrDialogStatus:false,
      flag: false,
    };
  },

  methods: {
    nameBlur() {
      crmCustomerValidataName({
        name: this.from.name,
        id: this.widowData.id,
      })
        .then((res) => {})
        .catch((res) => {
          this.from.name = "";
        });
    },
    gxrDialogTreeData(id, name) {
      if (this.flag) {
        this.from.gxr = id;
        this.gxrName = name;
      } else {
        this.ywyName = name;
        this.from.ywy = id;
      }
    },
    contactEmailInput(row) {
      var reg = /^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;
      if (reg.test(row.contactEmail)) {
      } else {
        row.contactEmail = "";
        this.msgInfo("邮箱格式不正确");
      }
    },
    handleCloseSh() {
      this.auditDialog = false;
    },
    handleClick(val) {
      if (this.widowData.type == "audit") {
        if (val.index == 1) {
          this.loginData();
        } else {
          this.editDataQuery();
        }
      }
    },
    auditDialogSubmit() {
      crmCustomerCheckStatus({
        customerId: this.widowData.id,
        type: 2,
        message: this.message,
      })
        .then((res) => {
          this.auditDialog = false;
          this.$message({
            message: "操作成功",
            type: "success",
            onClose: () => {
              this.resetGetList();
              this.hidenView();
            },
          });
        })
        .catch((res) => {});
    },
    auditClick(val) {
      if (val == 1) {
        this.$confirm("请确认审核信息, 是否继续?", "提示", {
          confirmButtonText: "确定",
          cancelButtonText: "取消",
          type: "warning",
        })
          .then(() => {
            this.loading = true;
            crmCustomerCheckStatus({
              customerId: this.widowData.id,
              type: val,
              message: this.message,
            })
              .then((res) => {
                this.$message({
                  message: "审核成功",
                  type: "success",
                  onClose: () => {
                    this.resetGetList();
                    this.hidenView();
                  },
                });
              })
              .catch((res) => {});
          })
          .catch(() => {
            this.$message({
              type: "info",
              message: "已取消删除",
            });
          });
      } else {
        this.auditDialog = true;
      }
    },
    fhhChange() {
      this.kphData = "";
    },
    kphChange() {
      this.fhhData = "";
    },
    downGxr() {
      this.dialogGxr = false;
      this.from.gxr = "";
      this.gxrName = "";
    },
    handleTreeClickR(data, checked, node) {
      if (checked == true) {
        this.$refs.treeR.setCheckedNodes([data]);
      }
    },
    nodeClickR(data, checked, node) {
      this.$refs.treeR.setCheckedNodes([data]);
    },
    queryName(row) {
      this.from.ssjt = row.name;
      this.dialogVisible = false;
    },
    //省市联动选择
    provinceChanged(value) {
      if (value !== "") {
        this.loadingCity = true;
        for (var item of this.provinces) {
          if (item.name === value) {
            this.cities = item.cities;
            this.city = "";
            this.loadingCity = false;
            break;
          } else {
            continue;
          }
        }
      } else {
        this.cities = [];
        this.city = "";
      }
      this.$emit("selectChange", this.province, this.city);
    },
    deleteTable(scope) {
      this.tableData.splice(scope.$index, 1);
    },
    appendClick() {
      this.tableData.push({
        contactName: "",
        contactGender: "",
        zw: "",
        sj: "",
        contactPhone: "",
        contactEmail: "",
        contactQq: "",
        cz: "",
        contactBirthday: "",
        remark: "",
        zycd: "",
      });
    },
    realRadioChange(val) {
      this.from.ywy = val.userId;
      this.ywyName = val.realname;
    },
    submitYwy() {
      this.dialogYwy = false;
      if (this.activeName == "department") {
        this.from.ywy = this.$refs.tree.getCheckedKeys().join("");
        this.ywyName = this.$refs.tree.getCheckedNodes()[0].name;
      } else if (this.activeName == "role") {
        this.from.ywy = this.$refs.treeR.getCheckedNodes()[0].userId;
        this.ywyName = this.$refs.treeR.getCheckedNodes()[0].realname;
        this.xsfzrRoleId = this.$refs.treeR.getCheckedKeys().join("");
      }
    },
    downYwy() {
      this.dialogYwy = false;
      this.from.ywy = "";
    },
    successClick() {
      let self = this;
      if (this.from.name == "") {
        this.msgInfo("请输入客户名称");
        return;
      }
      for (var i in this.tableData) {
        if (this.tableData[i].contactName == "") {
          this.msgInfo("请输入联系人姓名");
          return;
        }
        if (this.tableData[i].contactPhone == "") {
          this.msgInfo("请输入联系人工作电话");
          return;
        }
      }
      if (this.from.skqxszFlag == "发货后") {
        this.from.skqxszDays = this.fhhData;
      } else {
        this.from.skqxszDays = this.kphData;
      }
      let arr = [];
      for (var i in this.fileList) {
        arr.push(this.fileList[i].fileId);
      }
      this.from.fileIds = arr.join(",");
      this.from.crmCustomerContactList = this.tableData;
      if (this.widowData.type == "edit") {
        this.loading = true;
        crmCustomerAddOrUpdate(this.from)
          .then((res) => {
            this.$message({
              message: "编辑成功",
              type: "success",
              onClose: () => {
                this.resetGetList();
                this.hidenView();
                this.loading = false;
              },
            });
          })
          .catch((res) => {});
      } else {
        this.loading = true;
        crmCustomeraddOrUpdate(this.from)
          .then((res) => {
            this.$message({
              message: "新增成功",
              type: "success",
              onClose: () => {
                this.resetGetList();
                this.hidenView();
                this.loading = false;
              },
            });
          })
          .catch((res) => {});
      }
    },
    resetGetList() {
      window.opener.postMessage("child", window.location);
    },
    hidenView() {
      window.top.close();
    },
    getName(val) {
      var easyName = pinyin.getCamelChars(val);
      this.from.code = easyName.toUpperCase();
    },
    customerDialog() {
      if (this.from.ssjt != "") {
        this.dialogFrom.name = this.from.ssjt;
      }
      this.dialogVisible = true;
      this.dialogData();
    },
    handleClose() {
      this.dialogVisible = false;
    },
    ywyDialog() {
      this.gxrDialogStatus = true;
      this.flag = false;
    },
    gxrDialog() {
      this.gxrDialogStatus = true;
      this.flag = true;
    },
    handleCloseYwy() {
      this.dialogYwy = false;
    },
    realSearch() {
      this.duakigReal();
    },
    duakigReal() {
      usersList({
        page: 1,
        limit: 15,
        realname: this.realname,
        status: this.realStatus,
      })
        .then((res) => {
          this.realtableData = res.data.list;
        })
        .catch((res) => {});
    },
    dialogUserTree() {
      roleQueryRoleAndUser()
        .then((res) => {
          this.treeDataR = res.data;
          for (var i in this.treeDataR) {
            for (var k in this.treeDataR[i].user) {
              this.treeDataR[i].user[k].roleName = this.treeDataR[i].user[
                k
              ].realname;
              this.treeDataR[i].user[k].id =
                this.treeDataR[i].user[k].roleId +
                "" +
                this.treeDataR[i].user[k].userId;
            }
          }
        })
        .catch((res) => {});
    },
    dialogYwyTree() {
      deptQueryDeptTreeAndUser()
        .then((res) => {
          this.treeData = res.data;
        })
        .catch((res) => {});
    },
    search() {
      this.dialogData();
    },
    reset() {
      this.dialogFrom.page = 1;
      this.dialogFrom.limit = 15;
      this.dialogFrom.name = "";
      this.dialogFrom.code = "";
      this.dialogData();
    },
    handleSizeChange(val) {
      this.dialogFrom.limit = val;
      this.dialogData();
    },
    handleCurrentChange(val) {
      this.dialogFrom.page = val;
      this.dialogData();
    },
    dialogData() {
      xbjQueryCustomer(this.dialogFrom)
        .then((res) => {
          this.userTableData = res.data.list;
          this.total = res.data.totalRow;
        })
        .catch((res) => {});
    },
    deleteUpload(index) {
      this.fileList.splice(index, 1);
    },
    /** 图片选择出发 */
    xhUploadFile(event) {
      var files = event.target.files;
      if (files.length > 5) {
        this.msgInfo("最多支持上传5个文件");
        return;
      } else {
        if (files.length > 0) {
          var self = this;
          for (let index = 0; index < files.length; index++) {
            const file = files[index];
            this.sendFileRequest(file);
          }
        }
      }
    },
    sendFileRequest(file, result) {
      var params = { file: file };
      crmCustomerFileUpload(params)
        .then((res) => {
          if (this.fileList.length > 4) {
            return;
          }
          this.fileList.push({
            name: res.name,
            fileId: res.fileId,
          });
        })
        .catch(() => {});
    },
    loginData() {
      crmCustomerQueryEditById({
        customerId: this.widowData.id,
      })
        .then((res) => {
          this.from = res.data;
          if (res.data.gxr.length > 0) {
            this.gxrName = res.data.gxrName
              .map((item) => {
                return item.realname;
              })
              .join(",");
          }
          this.from.gxr = res.data.gxr;
          if (res.data.ywy != 0) {
            this.ywyName = res.data.ywyName;
            this.from.ywy = res.data.ywy;
          } else {
            this.from.ywy = res.data.ywy;
          }
          this.creatorName = res.data.creatorName;
          this.from.creator = res.data.creator;
          if (res.data.skqxszFlag == "发货后") {
            this.fhhData = res.data.skqxszDays;
          } else if (res.data.skqxszFlag == "开票后") {
            this.kphData = res.data.skqxszDays;
          }
          this.tableData = res.data.customerContactEdit;
        })
        .catch((res) => {});
    },
    editDataQuery() {
      crmCustomerQueryById({
        customerId: this.widowData.id,
      })
        .then((res) => {
          this.from = res.data;
          if (res.data.gxr.length > 0) {
            this.gxrName = res.data.gxrName
              .map((item) => {
                return item.realname;
              })
              .join(",");
          }
          this.from.gxr = res.data.gxr;
          if (res.data.ywy != 0) {
            this.ywyName = res.data.ywyName;
            this.from.ywy = res.data.ywy;
          } else {
            this.from.ywy = res.data.ywy;
          }
          this.creatorName = res.data.creatorName;
          this.from.creator = res.data.creator;
          if (res.data.skqxszFlag == "发货后") {
            this.fhhData = res.data.skqxszDays;
          } else if (res.data.skqxszFlag == "开票后") {
            this.kphData = res.data.skqxszDays;
          }
          this.tableData = res.data.customerContact;
        })
        .catch((res) => {});
    },
  },

  created() {},

  mounted() {
    this.provinces = dataList.addrs.provinces;
    this.widowData = this.$route.query;
    this.widowData.id = this.decode(this.$route.query.id);
    if (this.widowData.id != "") {
      if (this.widowData.type == "audit") {
        this.auditType = true;
        this.loginData();
      } else {
        this.auditType = false;
        this.editDataQuery();
      }
      if (this.widowData.type == "toView") {
        this.toViewType = true;
      } else {
        this.toViewType = false;
      }
      if (this.widowData.type == "review") {
        this.reviewType = true;
        this.toViewType = true;
      } else {
        this.reviewType = false;
      }
    } else {
      this.toViewType = false;
      this.reviewType = false;
      this.creatorName = Lockr.get("loginUserInfo").realname;
      this.from.createDate = this.getTime();
    }
  },
};
</script>
<style lang='scss'>
.create-flex .el-input__inner {
  height: 25px;
}
.create-flex .el-input-group__append {
  line-height: 23px;
}
.create-flex .el-input__icon {
  line-height: 25px;
}
.el-dialog__body {
  padding-top: 0;
}
#tab-csxx,
#tab-editxx {
  height: 44px;
  line-height: 44px;
}
.el-tabs .el-tabs__header {
  height: 44px;
}
</style>
<style lang='scss' scoped>
@import "../../manage/styles/table.scss";
@import "../../../styles/detail.scss";
.el-tab-department {
  height: 400px;
  overflow: auto;
}
.el-span {
  width: 60%;
  line-height: 25px;
  float: left;
}
.input-boxB {
  width: 100%;
  float: left;
  .input-label {
    width: 120px;
    line-height: 25px;
    float: left;
    display: block;
    text-align: left;
    color: #666;
    font-size: 14px;
  }
  .el-textarea {
    width: 90%;
    margin-bottom: 5px;
  }
}
.a-upload {
  padding: 0 10px;
  margin-top: 5px;
  height: 25px;
  line-height: 25px;
  position: relative;
  cursor: pointer;
  color: #888;
  background: #fafafa;
  border: 1px solid #ddd;
  border-radius: 4px;
  overflow: hidden;
  *display: inline;
  *zoom: 1;
  float: left;
}

.a-upload input {
  position: absolute;
  font-size: 100px;
  right: 0;
  top: 0;
  opacity: 0;
  filter: alpha(opacity=0);
  cursor: pointer;
}

.a-upload:hover {
  color: #444;
  background: #eee;
  border-color: #ccc;
  text-decoration: none;
}
.uploadStyle {
  width: 60%;
  float: left;
  line-height: 40px;
  li {
    min-width: 100px;
    float: left;
    margin: 0 5px;
  }
}
.el-icon-close {
  color: red;
  cursor: pointer;
}
.handle-bar {
  margin: 5px 0 20px 0;
}
</style>